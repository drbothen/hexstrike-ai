---
title: POST /api/vuln-intel/exploit-generate
group: api
handler: exploit_generate
module: __main__
line_range: [13671, 13742]
discovered_in_chunk: 13
---

# POST /api/vuln-intel/exploit-generate

## Entity Classification & Context
- **Kind:** Flask API endpoint
- **Scope:** Module-level
- **Module:** __main__ (reference-server.py)
- **Purpose:** Generate exploits from vulnerability data using AI with enhanced logging

## Complete Signature & Definition
```python
@app.route("/api/vuln-intel/exploit-generate", methods=["POST"])
def exploit_generate():
    """Generate exploits from vulnerability data using AI"""
```

## Purpose & Behavior
AI exploit generation endpoint providing:
- **CVE Analysis:** Analyze CVE for exploitability and context
- **Exploit Generation:** Generate custom exploits using AI
- **Target Customization:** Customize exploits for specific targets and architectures
- **Enhanced Logging:** Detailed logging of exploit generation process

## Request

### HTTP Method
- **Method:** POST
- **Path:** /api/vuln-intel/exploit-generate
- **Content-Type:** application/json

### Request Body
```json
{
    "cve_id": "string",              // Required: CVE identifier
    "target_os": "string",           // Optional: Target operating system
    "target_arch": "string",         // Optional: Target architecture (default: "x64")
    "exploit_type": "string",        // Optional: Exploit type (default: "poc")
    "evasion_level": "string",       // Optional: Evasion level (default: "none")
    "target_ip": "string",           // Optional: Target IP address
    "target_port": integer,          // Optional: Target port
    "target_description": "string"   // Optional: Target description
}
```

### Parameters
- **cve_id:** CVE identifier (required)
- **target_os:** Target operating system (optional)
- **target_arch:** Target architecture (optional, default: "x64")
- **exploit_type:** Type of exploit to generate (optional, default: "poc")
- **evasion_level:** Level of evasion techniques (optional, default: "none")
- **target_ip:** Target IP address (optional, default: "192.168.1.100")
- **target_port:** Target port (optional, default: 80)
- **target_description:** Description of target (optional)

## Response

### Success Response (200 OK)
```json
{
    "success": true,
    "cve_analysis": {
        "exploitability_level": "HIGH",
        "exploitability_score": 85
    },
    "exploit_generation": {
        "exploit_code": "#!/usr/bin/python3\n# Generated exploit for CVE-2024-1234\n...",
        "success": true,
        "exploit_type": "poc"
    },
    "existing_exploits": {
        "total_exploits": 3,
        "exploit_sources": ["exploit-db", "github"]
    },
    "target_info": {
        "target_os": "linux",
        "target_arch": "x64",
        "exploit_type": "poc"
    },
    "timestamp": "2024-01-01T12:00:00Z"
}
```

### Error Responses

#### Missing CVE ID (400 Bad Request)
```json
{
    "success": false,
    "error": "CVE ID parameter is required"
}
```

#### CVE Analysis Failed (400 Bad Request)
```json
{
    "success": false,
    "error": "Failed to analyze CVE CVE-2024-1234: CVE not found"
}
```

#### Server Error (500 Internal Server Error)
```json
{
    "success": false,
    "error": "Server error: {error_message}"
}
```

## Code Reproduction
```python
@app.route("/api/vuln-intel/exploit-generate", methods=["POST"])
def exploit_generate():
    """Generate exploits from vulnerability data using AI"""
    try:
        params = request.json
        cve_id = params.get("cve_id", "")
        target_os = params.get("target_os", "")
        target_arch = params.get("target_arch", "x64")
        exploit_type = params.get("exploit_type", "poc")
        evasion_level = params.get("evasion_level", "none")
        
        # Additional target context
        target_info = {
            "target_os": target_os,
            "target_arch": target_arch,
            "exploit_type": exploit_type,
            "evasion_level": evasion_level,
            "target_ip": params.get("target_ip", "192.168.1.100"),
            "target_port": params.get("target_port", 80),
            "description": params.get("target_description", f"Target for {cve_id}")
        }
        
        if not cve_id:
            logger.warning("ðŸ¤– Exploit generation called without CVE ID")
            return jsonify({
                "success": False,
                "error": "CVE ID parameter is required"
            }), 400
        
        logger.info(f"ðŸ¤– Generating exploit for {cve_id} | Target: {target_os} {target_arch}")
        
        # First analyze the CVE for context
        cve_analysis = cve_intelligence.analyze_cve_exploitability(cve_id)
        
        if not cve_analysis.get("success"):
            return jsonify({
                "success": False,
                "error": f"Failed to analyze CVE {cve_id}: {cve_analysis.get('error', 'Unknown error')}"
            }), 400
        
        # Prepare CVE data for exploit generation
        cve_data = {
            "cve_id": cve_id,
            "description": f"Vulnerability analysis for {cve_id}",
            "exploitability_level": cve_analysis.get("exploitability_level", "UNKNOWN"),
            "exploitability_score": cve_analysis.get("exploitability_score", 0)
        }
        
        # Generate exploit
        exploit_result = exploit_generator.generate_exploit_from_cve(cve_data, target_info)
        
        # Search for existing exploits for reference
        existing_exploits = cve_intelligence.search_existing_exploits(cve_id)
        
        result = {
            "success": True,
            "cve_analysis": cve_analysis,
            "exploit_generation": exploit_result,
            "existing_exploits": existing_exploits,
            "target_info": target_info,
            "timestamp": datetime.now().isoformat()
        }
        
        logger.info(f"ðŸŽ¯ Exploit generation completed for {cve_id}")
        return jsonify(result)
        
    except Exception as e:
        logger.error(f"ðŸ’¥ Error in exploit generation: {str(e)}")
        return jsonify({
            "success": False,
            "error": f"Server error: {str(e)}"
        }), 500
```
